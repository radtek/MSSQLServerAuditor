\documentclass[10pt,a4paper]{article}
\usepackage[utf8x]{inputenc}
\usepackage[left=2.5cm,right=2.0cm,top=1.75cm,bottom=1.75cm,bindingoffset=0cm]{geometry}
\usepackage[english,russian]{babel}
\usepackage[usenames,dvipsnames]{color}
\usepackage{caption}
\usepackage{listings}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{titlesec}
%\usepackage{hyperref}
\usepackage{lastpage}

\definecolor{gray}{rgb}{0.4,0.4,0.4}
\definecolor{darkblue}{rgb}{0.0,0.0,0.6}
\definecolor{cyan}{rgb}{0.0,0.6,0.6}

\setcounter{secnumdepth}{4}

\setlength{\parindent}{0cm}

\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

% this style should be active for all lstlistings environments
\lstdefinestyle{all}{
	basicstyle       = \small\sffamily,
	captionpos       = t,
	columns          = fullflexible,
	extendedchars    = false,
	frame            = lrtb,
	framerule        = 1pt,
	framexleftmargin = 1pt,
	inputencoding    = utf8x,
	keepspaces       = true,
	showstringspaces = false,
	tabsize          = 2
}

% this style should be active (additionally to "all") for "input" lstlistings environments
\lstdefinestyle{input}{
	commentstyle     = \itshape\color{red},
	tabsize          = 2
}

\lstset{
	basicstyle       = \small\sffamily,
	captionpos       = t,
	columns          = fullflexible,
	commentstyle     = \color{gray}\upshape,
	extendedchars    = false,
	frame            = 0rtb,
	framerule        = 0pt,
	framexleftmargin = 0pt,
	inputencoding    = utf8x,
	keepspaces       = true,
	language         = C,
	showstringspaces = false,
	stringstyle      = \bf,
	tabsize          = 2
}

\lstset{
	basicstyle       = \small\sffamily,
	captionpos       = t,
	columns          = fullflexible,
	commentstyle     = \color{gray}\upshape,
	extendedchars    = false,
	frame            = 0rtb,
	framerule        = 0pt,
	framexleftmargin = 0pt,
	inputencoding    = utf8x,
	keepspaces       = true,
	language         = XML,
	showstringspaces = false,
	stringstyle      = \bf,
	tabsize          = 2
}

%\lstset{ %
%	language=XML,                  % выбор языка для подсветки (здесь это XML)
%	%basicstyle=\small\sffamily,    % размер и начертание шрифта для подсветки кода
%	%numbers=left,                  % где поставить нумерацию строк (слева\справа)
%	%numberstyle=\tiny,             % размер шрифта для номеров строк
%	%stepnumber=1,                  % размер шага между двумя номерами строк
%	%numbersep=5pt,                 % как далеко отстоят номера строк от подсвечиваемого кода
%	backgroundcolor=\color{white}, % цвет фона подсветки - используем \usepackage{color}
%	showspaces=false,              % показывать или нет пробелы специальными отступами
%	showstringspaces=false,        % показывать или нет пробелы в строках
%	showtabs=false,                % показывать или нет табуляцию в строках
%	%frame=single,                  % рисовать рамку вокруг кода
%	tabsize=2,                     % размер табуляции по умолчанию равен 2 пробелам
%	%captionpos=t,                  % позиция заголовка вверху [t] или внизу [b]
%	breaklines=true,               % автоматически переносить строки (да\нет)
%	breakatwhitespace=false,       % переносить строки только если есть пробел
%	%escapeinside={\%*}{*)},        % если нужно добавить комментарии в коде
%	morekeywords={encoding,xs:schema,xs:element,xs:complexType,xs:sequence,xs:attribute}
%}

\lstdefinelanguage{XML}{
	%basicstyle      = \ttfamily\color{darkblue}\bfseries,
	basicstyle      = \ttfamily,
	morestring      = [b]",
	morestring      = [s]{>}{<},
	morecomment     = [s]{<?}{?>},
	stringstyle     = \color{black},
	identifierstyle = \color{darkblue},
	keywordstyle    = \color{cyan},
	morekeywords    = {xmlns,version,type}% list your attributes here
}

\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{\colorbox[cmyk]{0.43, 0.35, 0.35,0.01}{\parbox{\textwidth}{\hspace{15pt}#1#2#3}}}
\captionsetup[lstlisting]{format=listing,labelfont=white,textfont=white, singlelinecheck=false, margin=0pt, font={bf,footnotesize}}
\renewcommand{\lstlistingname}{Пример}

\let\oldquote\quote
\renewcommand\quote{\small\oldquote}

\setcounter{tocdepth}{4}

\begin{document}

\input{MSSQLServerAuditor.TechnicalSpecification.Version5.TitlePage.20130530}

\tableofcontents

\input{MSSQLServerAuditor.TechnicalSpecification.Version5.Legal.20130530}

\input{MSSQLServerAuditor.TechnicalSpecification.Version5.Tasks.20130530}

\end{document}

